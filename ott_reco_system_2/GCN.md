# GCN 기반 OTT 추천 시스템 코드 설명

이 코드는 PyTorch Geometric의 GCN(Graph Convolutional Network)을 활용하여 사용자 선호 기반의 OTT 콘텐츠 추천 시스템을 구현한 예시이다. 주요 흐름과 각 함수의 역할을 아래와 같이 정리한다.

## 1. 데이터 로드

-   `load_data()` 함수에서 콘텐츠 정보(`train_data.csv`)와 가격 정보(`ott_price.csv`)를 pandas DataFrame으로 불러온다.

## 2. 사용자 입력

-   `get_user_input()` 함수에서 사용자가 선호하는 장르, 세부 장르, 출연진, 연령대, 성별, 주간 시청 시간, 예산을 입력받는다.
-   입력값은 리스트 및 문자열, 실수형으로 반환된다.

## 3. 러닝타임 계산

-   `estimate_runtime_hours()` 함수는 각 콘텐츠의 러닝타임(분) 또는 에피소드 수를 바탕으로 시청 시간을 추정한다.
-   러닝타임 정보가 없으면 기본값 1.0을 반환한다.

## 4. GCN 모델 정의

-   `SimpleGCN` 클래스는 2개의 GCNConv 레이어로 구성된 간단한 GCN 모델이다.
-   입력 차원, 은닉 차원, 출력 차원을 지정할 수 있다.
-   forward에서는 두 번의 GCNConv와 ReLU 활성화 함수를 거친다.

## 5. 그래프 데이터 구축

-   `build_graph()` 함수는 다음과 같이 그래프를 구성한다.
    -   노드: 콘텐츠(작품), 세부 장르, 출연진, 가상 사용자 노드(`__user__`)
    -   엣지: 작품-세부장르, 작품-출연진, 사용자-세부장르, 사용자-출연진 간 연결
    -   각 노드는 one-hot 벡터로 임베딩된다.
    -   PyTorch Geometric의 Data 객체로 반환한다.

## 6. 추천 로직

-   `recommend()` 함수에서 실제 추천이 이루어진다.
    -   build_graph로 그래프 데이터 생성
    -   SimpleGCN 모델을 생성하고, 50 epoch 동안 사용자 노드 임베딩이 선호 장르/출연진 노드와 유사해지도록 학습(loss: cosine similarity 최대화)
    -   학습 후, 사용자 임베딩과 각 작품 노드 임베딩의 cosine similarity를 계산하여 상위 8개 작품을 추천한다.
    -   추천 결과는 DataFrame으로 반환된다.

## 7. 실행 흐름

-   main 블록에서 데이터 로드, 사용자 입력, 추천 함수 호출, 추천 결과 출력이 순차적으로 이루어진다.
-   추천 결과는 작품명, 세부 장르, 평점 형태로 출력된다.

## 특징 및 장점

-   사용자의 선호(장르, 세부 장르, 출연진 등)를 그래프 구조로 자연스럽게 반영할 수 있다.
-   GCN을 통해 간접적으로 연결된 노드(예: 비슷한 출연진, 장르 등)까지 임베딩에 반영되어 추천의 다양성과 연관성이 높아진다.
-   PyTorch Geometric을 활용해 그래프 신경망을 간결하게 구현할 수 있다.

## 한계 및 개선점

-   현재는 단순 one-hot 임베딩, 간단한 2-layer GCN만 사용한다.
-   평점, 시청 시간, 예산 등 다양한 정보를 feature로 추가하면 추천의 정밀도를 높일 수 있다.
-   실제 서비스에서는 cold-start 문제, 대규모 데이터 효율성, 하이퍼파라미터 튜닝 등이 추가로 필요하다.

---

실제 서비스 적용 시에는 데이터 전처리, feature engineering, 모델 고도화 등이 추가로 필요하다.

## 코드 전체 요약

-   사용자의 선호 정보를 그래프에 직접 반영하여, GCN을 통해 노드 임베딩을 학습하고, 임베딩 유사도를 기반으로 추천을 수행하는 구조이다.
-   추천 결과는 사용자의 입력 선호와 그래프 내 콘텐츠의 구조적 유사성을 모두 반영한다.
-   PyTorch Geometric의 Data, GCNConv 등 그래프 신경망 라이브러리의 기본 사용법을 익히는 데도 도움이 된다.
